
The Cloudlet Prototype, please visit our website at <http://elijah.cs.cmu.edu/>.

REQUIREMENTS
------------
- KVM >= qemu-kvm-0.12.3 
- Python >= 2.6.5
- ssh
- pyxdelta3
- gtkvncviewer

For Python Script
	xdelta3		:	binary diff
	pylmza		: compression
	gtkvncview	: vnc viewer
	poster		: Multipart HTTP POST only for emulated_client.py for 
	
For Android-client
	UPnP Discovery	: cling-core-1.0.5, teleal-command-1.0.13
	HTTP Client		: apache-mime4j-core, httpmime-4.1.1 (only for ISR Test)

	* All java lib depedency is self contained at Android-client/lib folder,
	  so do not need additional install

	
INSTALL 
------------
1. KVM (https://help.ubuntu.com/community/KVM/Installation)
	$ sudo apt-get install qemu-kvm libvirt-bin ubuntu-vm-builder bridge-utils
	
2. Libraries
	$ sudo apt-get install python-setuptools python-dev build-essential python-xdelta3 gtkvncviewer
	$ sudo easy_install pylzma
	$ sudo easy_install flask
	$ sudo easy_install poster


TESTING ENV
------------
Ubuntu Lucid(10.04)-desktop-x86_64


RUN SUMMARY
------------
1. Preparation
	1-1. Create Base VM
		- Cloudlet assumes pre-installed Base VM at Server-side.
		  You can generate Base VM (Disk + Memory) from KVM-QEMU disk image
		  (KVM-QMEU disk image can be raw or qcow2).
		- Run result: Base Disk(*.base.qcow2) and Base Memory Snapshot(*.base.mem)
		  at the input Disk image directory
		$ ./src/Script/cloudlet.py -b [KVM Image]
		ex) ./src/Script/cloudlet.py -b ./image/Ubuntu10.04/ubuntu.qcow2

	1-2. Create Overlay VM
		- You need to generate you own overlay VM, which will be saved to the mobile device.
		- This VM will carry your customized program and environment.
		- Run result: overlay Disk(*.qcow2.lzma) and memory snapshot(*.mem.lzma)
		$ ./src/Script/cloudlet.py -o [Base Disk] [Base Memeory]
		ex) ./src/Script/cloudlet.py -o .image/Ubuntu10.04/ubuntu.base.qcow2 .image/Ubuntu10.04/ubuntu.base.mem

	1-3. Copy Overlay VM to Android
		- Android Application will generate its working directory at SD card(/sdcard/Cloudlet/)
		- You should put overlay image on to that working direcotry following the
		  bellow directory structure.
		$ <working dir>/<BaseVM_name>/<Overlay_name>
		  where <BaseVM_name> is  <Overlay_name> is
		ex) $ ls /mnt/sdcard/UbuntuLucid/myCustomVM/
		     mycustomvm.qcow2.lzma
		     mycustomvm.mem.lzma

		- You can copy overlay image to Android phone using 'adb push' command

2. Run Cloudlet
	2-1. Create(Modify) Configuration file
		- Cloudlet Server requires configuration file that has Base VM information.
		- It is simple json format file that contains path information to Base VM.
		- See example at .src/Script/config/VM_config.json
		- You should modify
		  'name': unique VM name that will be used from client
		  'diskimg_path': path to base VM disk image
		  'memorysnapshot_path': path to base VM memory snapshot

		{
			"CPU-Clock":"2.13",
			"CPU-Core":"2",
			"Memory-Size":"4",
			"VM":[
			{
				"name":"ubuntuLTS",
				"type":"baseVM",
				"OS":"Linux",
				"OS-version":"Ubuntu_10.04 LTS",
				"diskimg_path":"/home/krha/Cloudlet/image/Ubuntu10.04_Base/ubuntu.base.qcow2",
				"memorysnapshot_path":"/home/krha/Cloudlet/image/Ubuntu10.04_Base/ubuntu.base.mem"
			},
			{
				"name":"windowXP",
				"type":"baseVM",
				"OS":"Window",
				"OS-version":"WindowXP",
				"diskimg_path":"/home/krha/Cloudlet/image/WindowXPPro_Base/winxp-with-jre.base.qcow2",
				"memorysnapshot_path":"/home/krha/Cloudlet/image/WindowXPPro_Base/winxp-with-jre.base.mem"
			}
			]
		}
                                                                                                                                                      }
	2-1. Run Cloudlet Server
		- Cloudlet Server is simple TCP server that handles client request.
		- It requres configuration file

		$ cd ./src/Script/
		$ ./synthesis.py run -c ./config/VM_config.json


	2-2. Run Cloudlet Client
		

